<!DOCTYPE html>
<html>
<head>
    <title>WiFi León - Acceso</title>
    <script>
        function login() {
            // 1. Extraer parámetros de la URL que envía el AP automáticamente
            const urlParams = new URLSearchParams(window.location.search);
            const ga_ap_mac = urlParams.get('ga_ap_mac');
            const ga_client_mac = urlParams.get('ga_client_mac');
            const ga_rssi = urlParams.get('ga_rssi');
            const ga_ssid = urlParams.get('ga_ssid');

            // 2. Construir el POST hacia cnMaestro
            // Al estar en modo 'Standard', el POST va a la URL de administración
            const postUrl = "https://us-e1-s30-prewqmt4q4.cloud.cambiumnetworks.com/cgi-bin/hotspot_login.cgi";

            const form = document.createElement('form');
            form.method = 'POST';
            form.action = postUrl;

            // Campos requeridos por cnMaestro para Clickthrough
            const fields = {
                'ga_ap_mac': ga_ap_mac,
                'ga_client_mac': ga_client_mac,
                'ga_rssi': ga_rssi,
                'ga_ssid': ga_ssid,
                'login': 'true' // Indica que se desea iniciar sesión
            };

            for (const key in fields) {
                const input = document.createElement('input');
                input.type = 'hidden';
                input.name = key;
                input.value = fields[key];
                form.appendChild(input);
            }

            document.body.appendChild(form);
            form.submit();
        }
    </script>
</head>
<body>
    <h1>Bienvenido al WiFi de León</h1>
    <p>Presiona el botón para navegar</p>
    <button onclick="login()" style="padding: 15px 30px; font-size: 18px;">CONECTAR</button>
</body>
</html>
